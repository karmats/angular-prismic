/**
 * 
 * @version v0.0.0 - 2014-05-07
 * @link 
 * @author 
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */angular.module("prismic.io",[]).factory("PrismicRequestHandler",["$http",function(a){return function(b,c){a.get(b).then(function(a){c(null,a.data)},function(a){c(a,null)})}}]).provider("Prismic",function(){this.$get=["$http","$window","PrismicRequestHandler","$q",function(a,b,c,d){var e=c,f=b.Prismic,g="",h=function(a){g=a},i="",j=function(a){i=a},k="",l=function(a){k=a},m="",n=function(a){m=a},o=function(a){for(var b,c={},d=/\+/g,e=/([^&=]+)=?([^&]*)/g,f=function(a){return decodeURIComponent(a.replace(d," "))};b=e.exec(a);)c[f(b[1])]=f(b[2]);return c},p=function(a){f.Api(m,a,g,e)},q=function(a,b){p(function(c,d){var e={ref:a||d.data.master.ref,api:d,maybeRef:a&&a!=d.data.master.ref?a:"",maybeRefParam:a&&a!=d.data.master.ref?"&ref="+a:"",oauth:function(){var a=g;return{accessToken:a,hasPrivilegedAccess:!!a}},linkResolver:function(a){return"detail.html?id="+a.id+"&slug="+a.slug+e.maybeRefParam}};b(e)})},r=function(a){q(s.ref,function(b){a.apply(window,[b])})},s=o(window.location.search.substring(1)),t=(o(window.location.hash.substring(1)),function(){var a=d.defer();return r(function(b){b.api.form("everything").ref(b.ref).submit(function(b,c){a.resolve(c)})}),a.promise}),u=function(a){var b=d.defer();return r(function(c){c.api.form("everything").ref(c.ref).query(a).submit(function(a,c){b.resolve(c)})}),b.promise};return{setAccessToken:h,setClientId:j,setClientSecret:l,setAPIEndpoint:n,get:t,query:u}}]});